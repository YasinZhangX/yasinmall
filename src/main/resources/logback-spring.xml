<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="false">
  <contextName>logback</contextName>
  <!--导入属性配置-->
  <!-- 日志根目录-->
  <springProperty scope="context" name="LOG_HOME" source="logging.path" defaultValue="D:\\mallProject\\yasinmall_log"/>

  <!-- 日志级别 -->
  <springProperty scope="context" name="LOG_ROOT_LEVEL" source="logging.level.root" defaultValue="DEBUG"/>

  <!--  标识这个"STDOUT" 将会添加到这个logger -->
  <springProperty scope="context" name="STDOUT" source="log.stdout" defaultValue="STDOUT"/>

  <!-- 日志文件名称-->
  <property name="LOG_PREFIX" value="spring-boot-logback" />

  <!-- 日志文件编码-->
  <property name="LOG_CHARSET" value="UTF-8" />

  <!-- 日志文件路径+日期-->
  <property name="LOG_DIR" value="${LOG_HOME}/%d{yyyyMMdd}" />

  <!--对日志进行格式化-->
  <property name="LOG_MSG" value="[%d{HH:mm:ss.SSS}][%p][%c{40}][%t] %m%n"/>

  <!--文件大小，默认10MB-->
  <property name="MAX_FILE_SIZE" value="10MB" />

  <!-- 配置日志的滚动时间 ，表示只保留最近 10 天的日志-->
  <property name="MAX_HISTORY" value="10"/>

  <!--输出到控制台-->
  <appender name="console" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <pattern>[%d{HH:mm:ss.SSS}][%p][%c{40}][%t] %m%n</pattern>
    </encoder>
    <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
      <level>DEBUG</level>
    </filter>
  </appender>

  <!--输出到文件-->
  <appender name="yasinmall" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>yasinmall.log</file>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <fileNamePattern>yasinmall.log.%d{yyyy-MM-dd}.gz</fileNamePattern>
      <maxHistory>10</maxHistory>
    </rollingPolicy>
    <encoder>
      <pattern>[%d{HH:mm:ss.SSS}][%p][%c{40}][%t] %m%n</pattern>
    </encoder>
  </appender>

  <appender name="error" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <File>error.log</File>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <fileNamePattern>error.log.%d{yyyy-MM-dd}.gz</fileNamePattern>
      <!--<append>true</append>-->
      <maxHistory>10</maxHistory>
    </rollingPolicy>
    <encoder>
      <pattern>[%d{HH:mm:ss.SSS}][%p][%c{40}][%t] %m%n</pattern>
    </encoder>
    <filter class="ch.qos.logback.classic.filter.LevelFilter">
      <level>ERROR</level>
      <onMatch>ACCEPT</onMatch>
      <onMismatch>DENY</onMismatch>
    </filter>
  </appender>

  <logger name="com.yasinmall" additivity="false" level="INFO" >
    <appender-ref ref="yasinmall" />
    <appender-ref ref="console"/>
  </logger>

  <!-- 测试环境+开发环境. 多个使用逗号隔开. -->
  <springProfile name="test,dev">
    <logger name="com.yasinmall" additivity="false" level="INFO" >
      <appender-ref ref="yasinmall" />
      <appender-ref ref="console"/>
    </logger>
  </springProfile>
  <!-- 生产环境. -->
  <springProfile name="prod">
    <logger name="com.yasinmall" additivity="false" level="ERROR" >
      <appender-ref ref="yasinmall" />
      <appender-ref ref="console"/>
    </logger>
  </springProfile>

  <!-- mybatis log 日志 -->
  <logger name="com.yasinmall.dao" level="DEBUG"/>

  <root level="DEBUG">
    <appender-ref ref="console"/>
    <appender-ref ref="error"/>
  </root>
</configuration>
